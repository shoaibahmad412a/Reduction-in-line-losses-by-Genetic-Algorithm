clc
clear
basemva = 100;  accuracy = 0.01; accel = 1.8; maxiter = 100;

%        IEEE 5-BUS TEST SYSTEM 
%        Bus Bus  Voltage Angle   ---Load---- -------Generator----- Static Mvar
%        No  code Mag.    Degree  MW    Mvar  MW  Mvar Qmin Qmax    +Qc/-Ql
busdata=[  1	0	1	0	0	0	0	0	0	0	0
2	0	1	0	0	0	0	0	0	0	0
3	0	1	0	0	0	0	0	0	0	0
4	0	1	0	0	0	0	0	0	0	0
5	0	1	0	0	0	0	0	0	0	0
6	0	1	0	0	0	0	0	0	0	0
7	0	1	0	0	0	0	0	0	0	0
8	0	1	0	0	0	0	0	0	0	0
9	0	1	0	0	0	0	0	0	0	0
10	0	1	0	0	0	0	0	0	0	0
11	0	1	0	0	0	0	0	0	0	0
12	0	1	0	0	0	0	0	0	0	0
13	0	1	0	0	0	0	0	0	0	0
14	0	1	0	0	0	0	0	0	0	0
15	0	1	0	0	0	0	0	0	0	0
16	0	1	0	0	0	0	0	0	0	0
17	0	1	0	0	0	0	0	0	0	0
18	0	1	0	0	0	0	0	0	0	0
19	0	1	0	0	0	0	0	0	0	0
20	0	1	0	0	0	0	0	0	0	0
21	0	1	0	0	0	0	0	0	0	0
22	0	1	0	0	0	0	0	0	0	0
23	0	1	0	0	0	0	0	0	0	0
24	0	1	0	0	0	0	0	0	0	0
25	0	1	0	0	0	0	0	0	0	0
26	0	1	0	0	0	0	0	0	0	0
27	0	1	0	0	0	0	0	0	0	0
28	0	1	0	0	0	0	0	0	0	0
29	0	1	0	0	0	0	0	0	0	0
30	0	1	0	0	0	0	0	0	0	0
31	0	1	0	0	0	0	0	0	0	0
32	0	1	0	0	0	0	0	0	0	0
33	0	1	0	0	0	0	0	0	0	0
34	0	1	0	0	0	0	0	0	0	0
35	0	1	0	0	0	0	0	0	0	0
36	0	1	0	0	0	0	0	0	0	0
37	0	1	0	0	0	0	0	0	0	0
38	0	1	0	0	0	0	0	0	0	0
39	0	1	0	0	0	0	0	0	0	0
40	0	1	0	0	0	0	0	0	0	0
41	0	1	0	0	0	0	0	0	0	0
42	0	1	0	0	0	0	0	0	0	0
43	0	1	0	0	0	0	0	0	0	0
44	0	1	0	0	0	0	0	0	0	0
45	0	1	0	0	0	0	0	0	0	0
46	0	1	0	0	0	0	0	0	0	0
47	0	1	0	0	0	0	0	0	0	0
48	0	1	0	0	0	0	0	0	0	0
49	0	1	0	0	0	0	0	0	0	0
50	0	1	0	0	0	0	0	0	0	0
51	0	1	0	0	0	0	0	0	0	0
52	0	1	0	0	0	0	0	0	0	0
53	0	1	0	0	0	0	0	0	0	0
54	0	1	0	0	0	0	0	0	0	0
55	0	1	0	0	0	0	0	0	0	0
56	0	1	0	0	0	0	0	0	0	0
57	0	1	0	0	0	0	0	0	0	0
58	0	1	0	0	0	0	0	0	0	0
59	0	1	0	0	0	0	0	0	0	0
60	0	1	0	0	0	0	0	0	0	0
61	0	1	0	0	0	0	0	0	0	0
62	0	1	0	0	0	0	0	0	0	0
63	0	1	0	0	0	0	0	0	0	0
64	0	1	0	0	0	0	0	0	0	0
65	0	1	0	0	0	0	0	0	0	0
66	0	1	0	0	0	0	0	0	0	0
67	0	1	0	0	0	0	0	0	0	0
68	0	1	0	0	0	0	0	0	0	0
69	0	1	0	0	0	0	0	0	0	0
70	0	1	0	0	0	0	0	0	0	0
71	0	1	0	0	0	0	0	0	0	0
72	0	1	0	0	0	0	0	0	0	0
73	0	1	0	0	0	0	0	0	0	0
74	0	1	0	0	0	0	0	0	0	0
75	0	1	0	0	0	0	0	0	0	0
76	0	1	0	0	0	0	0	0	0	0
77	0	1	0	0	0	0	0	0	0	0
78	0	1	0	0	0	0	0	0	0	0
79	0	1	0	0	0	0	0	0	0	0
80	0	1	0	0	0	0	0	0	0	0
81	0	1	0	0	0	0	0	0	0	0
82	0	1	0	0	0	0	0	0	0	0
83	0	1	0	0	0	0	0	0	0	0
84	0	1	0	0	0	0	0	0	0	0
85	0	1	0	0	0	0	0	0	0	0
86	0	1	0	0	0	0	0	0	0	0
87	0	1	0	0	0	0	0	0	0	0
88	0	1	0	0	0	0	0	0	0	0
89	0	1	0	0	0	0	0	0	0	0
90	0	1	0	0	0	0	0	0	0	0
91	0	1	0	0	0	0	0	0	0	0
92	0	1	0	0	0	0	0	0	0	0
93	0	1	0	0	0	0	0	0	0	0
94	0	1	0	0	0	0	0	0	0	0
95	0	1	0	0	0	0	0	0	0	0
96	0	1	0	0	0	0	0	0	0	0
97	0	1	0	0	0	0	0	0	0	0
98	0	1	0	0	0	0	0	0	0	0
99	0	1	0	0	0	0	0	0	0	0
100	0	1	0	0	0	0	0	0	0	0
101	0	1	0	0	0	0	0	0	0	0
102	0	1	0	0	0	0	0	0	0	0
103	0	1	0	0	0	0	0	0	0	0
104	0	1	0	0	0	0	0	0	0	0
105	0	1	0	0	0	0	0	0	0	0
106	0	1	0	0	0	0	0	0	0	0
107	0	1	0	0.003	0.002	0	0	0	0	0
108	0	1	0	0.008	0.005	0	0	0	0	0
109	0	1	0	0.026	0.019	0	0	0	0	0
110	0	1	0	0	0	0	0	0	0	0
111	1	1	0	0	0	4.194	1.473	0	0	0
112	0	1	0	0	0	0	0	0	0	0
113	0	1	0	0.004	0	0	0	0	0	0
114	0	1	0	0	0	0	0	0	0	0
115	0	1	0	0	0	0	0	0	0	0
116	0	1	0	0.016	0	0	0	0	0	0
117	0	1	0	0.016	0	0	0	0	0	0
118	0	1	0	0.014	0.009	0	0	0	0	0
119	0	1	0	0.028	0.017	0	0	0	0	0
120	0	1	0	0.004	0	0	0	0	0	0
121	0	1	0	0.018	0	0	0	0	0	0
122	0	1	0	0.008	0.005	0	0	0	0	0
123	0	1	0	0.002	0.001	0	0	0	0	0
124	0	1	0	0.018	0	0	0	0	0	0
125	0	1	0	0.066	0	0	0	0	0	0
126	0	1	0	0.017	0.01	0	0	0	0	0
127	0	1	0	0.009	0.006	0	0	0	0	0
128	0	1	0	0.006	0	0	0	0	0	0
129	0	1	0	0.02	0	0	0	0	0	0
130	0	1	0	0.018	0	0	0	0	0	0
131	0	1	0	0.029	0.018	0	0	0	0	0
132	0	1	0	0.015	0.009	0	0	0	0	0
133	0	1	0	0.018	0	0	0	0	0	0
134	0	1	0	0.015	0.009	0	0	0	0	0
135	0	1	0	0.008	0.005	0	0	0	0	0
136	0	1	0	0.005	0.003	0	0	0	0	0
137	0	1	0	0.031	0.019	0	0	0	0	0
138	0	1	0	0.018	0.011	0	0	0	0	0
139	0	1	0	0.031	0.019	0	0	0	0	0
140	0	1	0	0.031	0.019	0	0	0	0	0
141	0	1	0	0.026	0.016	0	0	0	0	0
142	0	1	0	0.014	0.008	0	0	0	0	0
143	0	1	0	0.002	0.001	0	0	0	0	0
144	0	1	0	0.006	0.004	0	0	0	0	0
145	0	1	0	0.013	0.008	0	0	0	0	0
146	0	1	0	0.027	0.017	0	0	0	0	0
147	0	1	0	0.014	0.008	0	0	0	0	0
148	0	1	0	0.005	0	0	0	0	0	0
149	0	1	0	0.009	0	0	0	0	0	0
150	0	1	0	0.015	0.009	0	0	0	0	0
151	0	1	0	0.032	0	0	0	0	0	0
152	0	1	0	0.004	0.002	0	0	0	0	0
153	0	1	0	0.013	0.008	0	0	0	0	0
154	0	1	0	0.007	0.004	0	0	0	0	0
155	0	1	0	0.028	0.017	0	0	0	0	0
156	0	1	0	0.063	0	0	0	0	0	0
157	0	1	0	0.007	0.004	0	0	0	0	0
158	0	1	0	0.031	0.019	0	0	0	0	0
159	0	1	0	0.018	0.011	0	0	0	0	0
160	0	1	0	0.003	0.002	0	0	0	0	0
161	0	1	0	0.026	0.016	0	0	0	0	0
162	1	1	0	0.032	0	0	0	0	0	0
163	0	1	0	0.018	0.011	0	0	0	0	0
164	0	1	0	0.008	0.005	0	0	0	0	0
165	0	1	0	0.026	0.016	0	0	0	0	0
166	0	1	0	0.018	0.011	0	0	0	0	0
167	0	1	0	0.036	0	0	0	0	0	0
168	0	1	0	0.051	0.032	0	0	0	0	0
169	0	1	0	0.018	0	0	0	0	0	0
170	0	1	0	0.013	0.008	0	0	0	0	0
171	0	1	0	0.032	0	0	0	0	0	0
172	0	1	0	0.013	0.008	0	0	0	0	0
173	0	1	0	0.026	0.016	0	0	0	0	0
174	0	1	0	0.031	0.019	0	0	0	0	0
175	0	1	0	0.021	0	0	0	0	0	0
176	0	1	0	0.004	0.002	0	0	0	0	0
177	0	1	0	0.031	0.019	0	0	0	0	0



];

%                                        Line code
%         Bus bus   R      X     1/2 B   = 1 for lines
%         nl  nr  p.u.   p.u.   p.u.     > 1 or < 1 tr. tap at bus nl
linedata=[ 1	2	0.005	0.0069	0.623188406	1
2	3	0.0652	0.1645	0.537993921	1
3	4	0.0056	0.0143	0.534965035	1
4	5	0.0086	0.0218	0.536697248	1
5	6	0.0142	0.0358	0.537709497	1
6	7	0.0043	0.0099	0.545454545	1
7	8	0.0244	0.0617	0.537277147	1
8	9	0.0311	0.0785	0.538216561	1
9	10	0.0537	0.1355	0.53800738	1
10	11	0.0036	0.0083	0.542168675	1
11	12	0.0596	0.1371	0.544857768	1
12	13	0.0113	0.0384	0.522135417	1
13	14	0.0086	0.029	0.522413793	1
14	15	0.0507	0.1555	0.525723473	1
15	16	0.0043	0.0131	0.526717557	1
16	17	0.0059	0.0182	0.524725275	1
17	18	0.0207	0.0635	0.525984252	1
18	19	0.0039	0.012	0.529166667	1
19	20	0.0141	0.0434	0.525345622	1
20	21	0.0087	0.0267	0.526217228	1
21	22	0.0121	0.0372	0.52688172	1
22	23	0.0082	0.0252	0.525793651	1
23	24	0.0114	0.035	0.527142857	1
3	25	0.0071	0.0217	0.525345622	1
4	26	0.00011	0.0033	0.053030303	1
6	27	0.0029	0.009	0.522222222	1
27	28	0.0029	0.009	0.522222222	1
27	29	0.0119	0.0274	0.545620438	1
29	30	0.0029	0.009	0.522222222	1
7	31	0.0031	0.0071	0.542253521	1
8	32	0.0378	0.087	0.544827586	1
32	33	0.0063	0.0144	0.545138889	1
33	34	0.0065	0.0149	0.543624161	1
34	35	0.0045	0.0138	0.525362319	1
35	36	0.0055	0.0169	0.523668639	1
36	37	0.0044	0.0134	0.52238806	1
37	38	0.0011	0.0035	0.528571429	1
38	39	0.0087	0.0267	0.526217228	1
39	40	0.0089	0.0274	0.525547445	1
40	41	0.0163	0.0501	0.525948104	1
41	42	0.0056	0.0171	0.526315789	1
42	43	0.0087	0.0267	0.526217228	1
43	44	0.012	0.0368	0.525815217	1
44	45	0.0011	0.0035	0.528571429	1
45	46	0.0086	0.0265	0.526415094	1
32	47	0.0055	0.0169	0.523668639	1
47	48	0.0075	0.0265	0.520754717	1
48	49	0.0118	0.0361	0.526315789	1
49	50	0.0087	0.0267	0.526217228	1
50	51	0.013	0.0399	0.525062657	1
51	52	0.0123	0.0377	0.525198939	1
52	53	0.0054	0.0166	0.527108434	1
53	54	0.0044	0.0134	0.52238806	1
48	55	0.0177	0.0543	0.525782689	1
52	56	0.0077	0.0272	0.518382353	1
36	57	0.0089	0.0274	0.525547445	1
38	58	0.0043	0.0131	0.526717557	1
38	59	0.0041	0.0127	0.527559055	1
40	60	0.0033	0.0101	0.524752475	1
60	61	0.005	0.0153	0.526143791	1
61	62	0.0076	0.0234	0.525641026	1
62	63	0.0635	0.1947	0.525937339	1
60	64	0.0066	0.0201	0.527363184	1
41	65	0.0093	0.0285	0.524561404	1
65	66	0.0034	0.012	0.516666667	1
41	67	0.0077	0.0236	0.527542373	1
42	68	0.00174	0.00534	0.0526217228	1
44	69	0.0099	0.0302	0.526490066	1
9	70	0.0167	0.0593	0.520236088	1
70	71	0.0125	0.0383	0.526109661	1
71	72	0.0049	0.0151	0.526490066	1
70	73	0.0004	0.0013	0.538461538	1
71	74	0.0049	0.0151	0.526490066	1
10	75	0.0047	0.0167	0.520958084	1
12	76	0.0047	0.0167	0.520958084	1
12	77	0.0085	0.0196	0.545918367	1
77	78	0.0074	0.0228	0.526315789	1
77	79	0.0028	0.0085	0.529411765	1
13	80	0.0066	0.0204	0.524509804	1
14	81	0.0068	0.0208	0.526442308	1
15	82	0.0018	0.0414	0.54468599	1
17	83	0.0128	0.0295	0.545762712	1
83	84	0.0059	0.018	0.525	    1
84	85	0.00057	0.0175	0.00525714286	1
85	86	0.0033	0.0101	0.524752475	1
86	87	0.0065	0.0199	0.527638191	1
87	88	0.0106	0.0326	0.52607362	1
84	89	0.0023	0.008	0.525	    1
89	90	0.0115	0.0265	0.545283019	1
84	91	0.0033	0.0101	0.524752475	1
91	92	0.0136	0.0312	0.544871795	1
92	93	0.0056	0.013	0.2546153846	1
86	94	0.0009	0.0026	0.538461538	1
20	95	0.0066	0.0201	0.527363184	1
95	96	0.0188	0.0576	0.526041667	1
95	97	0.00141	0.00434	0.0525345622	1
95	98	0.00187	0.043	0.545348837	1
21	99	0.0219	0.0503	0.545725646	1
22	100	0.0029	0.0088	0.522727273	1
100	101	0.0024	0.0072	0.527777778	1
101	102	0.0041	0.0127	0.527559055	1
102	103	0.0086	0.0265	0.526415094	1
103	104	0.005	0.0153	0.526143791	1
101	105	0.0011	0.033	0.253030303	1
102	106	0.0059	0.018	0.525	    1

65	107	56.5685	56.33474587	0.710041368	1
66	108	26.1411	40.2572	0.596166648	1
25	109	3.8483	19.6263	0.509520388	1
1	110	0.0579	0.894388843	0.503136867	1
26	111	56.5685	54.5685	0.707107312	1
5	112	3.8483	19.6263	0.509520388	1
29	113	9.7198	28.26451983	0.530700684	1
30	114	9.7198	28.3818	0.528507706	1
28	115	3.8483	19.6263	0.509520388	1
31	116	56.5685	56.33474587	0.710041368	1
55	117	9.7198	28.3818	0.528507706	1
49	118	26.1411	40.2572	0.596166648	1
50	119	106.066	105.6277107	0.710040949	1
51	120	9.7198	28.3818	0.528507706	1
56	121	2.1647	11.0398	0.5095201	1
54	122	9.7198	28.26451983	0.530700684	1
53	123	26.1411	40.2572	0.596166648	1
33	124	65.0538	65.0538	0.707107041	1
34	125	9.7198	28.26451983	0.530700684	1
35	126	9.7198	28.3818	0.528507706	1
57	127	3.8483	19.6263	0.509520388	1
59	128	9.7198	28.26451983	0.530700684	1
58	129	9.7198	28.3818	0.528507706	1
39	130	9.7198	28.3818	0.528507706	1
91	131	26.1411	40.09084793	0.598640369	1
92	132	26.1411	40.2572	0.596166648	1
64	133	3.8483	19.6263	0.509520388	1
40	134	9.7198	28.26451983	0.530700684	1
61	135	3.8483	19.6263	0.509520388	1
62	136	3.8483	19.6263	0.509520388	1
63	137	3.8483	19.54519959	0.511634581	1
67	138	9.7198	28.3818	0.528507706	1
68	139	94.2809	94.2809	0.707106636	1
43	140	26.1411	40.09084793	0.598640369	1
44	141	9.7198	28.3818	0.528507706	1
45	142	3.8483	19.6263	0.509520388	1
46	143	3.8483	19.54519959	0.511634581	1
74	145	26.1411	40.2572	0.596166648	1
72	144	65.0538	65.0538	0.707107041	1
73	146	9.7198	28.26451983	0.530700684	1
75	147	9.0026	32.4092	0.518932896	1
79	148	65.0538	65.0538	0.707107041	1
78	149	9.7198	28.26451983	0.530700684	1
76	150	26.1411	40.2572	0.596166648	1
13	151	3.8483	19.6263	0.509520388	1
80	152	2.1647	10.99418099	0.511634291	1
81	153	26.1411	40.2572	0.596166648	1
16	154	3.8483	19.6263	0.509520388	1
83	155	9.7198	28.26451983	0.530700684	1
90	156	65.0538	65.0538	0.707107041	1
89	157	5.0028	25.5142	0.509520189	1
93	158	6.6019	23.66859008	0.521085116	1
85	159	9.7198	28.3818	0.528507706	1
94	160	26.1411	40.2572	0.596166648	1
87	161	3.8483	19.54519959	0.511634581	1
88	162	9.7198	28.3818	0.528507706	1
18	163	5.0028	25.5142	0.509520189	1
19	164	1.7104	8.686755372	0.51163522	1
20	165	9.7198	28.3818	0.528507706	1
95	166	9.7198	28.3818	0.528507706	1
96	167	3.8483	19.54519959	0.511634581	1
97	168	9.7198	28.3818	0.528507706	1
98	169	3.8483	19.6263	0.509520388	1
99	170	3.8483	19.54519959	0.511634581	1
21	171	9.7198	28.3818	0.528507706	1
100	172	65.0538	65.0538	0.707107041	1
23	173	3.8483	19.54519959	0.511634581	1
24	174	3.8483	19.6263	0.509520388	1
105	175	3.8483	19.6263	0.509520388	1
104	176	9.7198	28.26451983	0.530700684	1
103	177	9.7198	28.3818	0.528507706	1


		];

lfybus                            % form the bus admittance matrix
lfnewton                % Load flow solution by Newton Raphson method
busout              % Prints the power flow solution on the screen
lineflow          % Computes and displays the line flow and losses

